<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Weekly Calendar View</title>
    <style>
        /* Calendar styling */
        .calendar-container { display: grid; grid-template-columns: 80px repeat(7, 1fr); gap: 1px; width: 100%; max-width: 1200px; margin: 20px auto; border: 1px solid #ddd; }
        .day-header, .time-slot { background-color: #f3e5f5; padding: 10px; text-align: center; font-weight: bold; border-bottom: 1px solid #ddd; }
        .time-column { display: flex; flex-direction: column; }
        .time-slot { height: 60px; border-right: 1px solid #ddd; }
        .day-column { position: relative; background-color: white; border-right: 1px solid #ddd; }
        .event-block { position: absolute; left: 5%; width: 90%; padding: 5px; background-color: #800080; color: white; border-radius: 5px; font-size: 0.9em; box-sizing: border-box; overflow: hidden; }
        .event-title { font-weight: bold; margin-bottom: 3px; }
        .event-time { font-size: 0.85em; }
    </style>
</head>
<body>
    <h1>Weekly Calendar</h1>
    <div class="calendar-container">
        <div class="time-column"></div> <!-- Empty cell for time column header -->
        {% for day in days_of_week %}
            <div class="day-header">{{ day }}</div>
        {% endfor %}

        <div class="time-column">
            {% for time in times %}
                <div class="time-slot">{{ time }}</div>
            {% endfor %}
        </div>

        {% for day in days_of_week %}
            <div class="day-column">
                {% for time in times %}
                    <div class="time-slot">
                        {% with events=events_by_day.day.time %}
                            {% if events %}
                                {% for event in events %}
                                    <div class="event-block" 
                                         style="top: calc(60px * {{ event.start_time.hour|default:8 }}); 
                                                height: calc(60px * ({{ event.end_time.hour|default:event.start_time.hour }} - {{ event.start_time.hour|default:8 }}));">
                                        <div class="event-title">{{ event.title }}</div>
                                        <div class="event-time">{{ event.start_time|time:"g:i A" }} - {{ event.end_time|time:"g:i A" }}</div>
                                        <div>{{ event.location }}</div>
                                    </div>
                                {% endfor %}
                            {% endif %}
                        {% endwith %}
                    </div>
                {% endfor %}
            </div>
        {% endfor %}
    </div>
</body>
</html>
